bool x;

void foo() {
    if (*)
      call foo();
    while (x) {
    }
    x = true;
}

void bar() {
    if (*)
      call bar();
    while (!x) {
    }
    x = false;
}

void main() {
    create_thread(&foo);
    create_thread(&bar);
}