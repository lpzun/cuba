bool x = 1;
bool y = 0;

void foo() {
	atmoic{
		bool l1 = *;
		bool l2 = *;
		bool l3 = *;
	}
	atomic {
		if (x) {
			x = 0;
			l1 = x;
			l2 = !x;
			foo();
		}
	}
	if (!l1 && !l2 && !l3)
		foo();
}

void bar() {
	bool l1;
L:
	x = 1;
	if (!l1)
		l1 = x;
	goto L;
}

void main() {
	create_thread(&foo);
	create_thread(&foo);
	create_thread(&bar);
	create_thread(&bar);
}